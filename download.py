import requests
import datetime

coordinates = [
    [2008, -33.891348, 151.191243],
    [2010, -33.888821, 151.213328],
    [2018, -33.920412, 151.203107],
    [2021, -33.885032, 151.226475],
    [2025, -33.885795, 151.24413],
    [2026, -33.897439, 151.271839],
    [2029, -33.866555, 151.280456],
    [2031, -33.920227, 151.242689],
    [2034, -33.931293, 151.256089],
    [2037, -33.880815, 151.187791],
    [2039, -33.863063, 151.170573],
    [2041, -33.853386, 151.180609],
    [2044, -33.924777, 151.160747],
    [2046, -33.856828, 151.130728],
    [2047, -33.851056, 151.154542],
    [2048, -33.897351, 151.16535],
    [2066, -33.825587, 151.159934],
    [2074, -33.722839, 151.126134],
    [2076, -33.716405, 151.118119],
    [2077, -33.709541, 151.104136],
    [2079, -33.664817, 151.117161],
    [2081, -33.589491, 151.171015],
    [2082, -33.601653, 151.11837],
    [2084, -33.683644, 151.22847],
    [2085, -33.738731, 151.194197],
    [2086, -33.751488, 151.245461],
    [2087, -33.773728, 151.216125],
    [2088, -33.822964, 151.242292],
    [2092, -33.797106, 151.251146],
    [2093, -33.787074, 151.251721],
    [2096, -33.784595, 151.287817],
    [2099, -33.761652, 151.295691],
    [2100, -33.767737, 151.266062],
    [2111, -33.831448, 151.117286],
    [2119, -33.76169, 151.079364],
    [2120, -33.711956, 151.072836],
    [2126, -33.722019, 151.041806],
    [2134, -33.876154, 151.103933],
    [2135, -33.873913, 151.093993],
    [2137, -33.85746, 151.091954],
    [2154, -33.732307, 151.005616],
    [2159, -33.652661, 151.043059],
    [2162, -33.885501, 151.011469],
    [2190, -33.917157, 151.047838],
    [2196, -33.933167, 151.073197],
    [2198, -33.912851, 150.982469],
    [2200, -33.917157, 151.047838],
    [2203, -33.904689, 151.138774],
    [2204, -33.915178, 151.151568],
    [2205, -33.930744, 151.155272],
    [2207, -33.959548, 151.117388],
    [2208, -33.939481, 151.098941],
    [2209, -33.948609, 151.069628],
    [2211, -33.971073, 151.030955],
    [2216, -33.952747, 151.137624],
    [2218, -33.968523, 151.124528],
    [2219, -33.990614, 151.133074],
    [2220, -33.965517, 151.104903],
    [2224, -34.019802, 151.115847],
    [2227, -34.048156, 151.086087],
    [2228, -34.049866, 151.104325],
    [2229, -34.078313, 151.102646],
    [2230, -34.048276, 151.141431],
    [2231, -34.008487, 151.204879],
    [2233, -34.058462, 151.03279],
    [2250, -33.40485, 151.350776],
    [2251, -33.470568, 151.360536],
    [2259, -33.222529, 151.277495],
    [2260, -33.418298, 151.446193],
    [2261, -33.362679, 151.447302],
    [2262, -33.209738, 151.51616],
    [2263, -33.265459, 151.540695],
    [2264, -33.100922, 151.544375],
    [2265, -33.055785, 151.406243],
    [2278, -32.956584, 151.560504],
    [2280, -33.008886, 151.635155],
    [2281, -33.09521, 151.657053],
    [2282, -32.975418, 151.644682],
    [2283, -33.01329, 151.593162],
    [2284, -32.982483, 151.605192],
    [2285, -32.953151, 151.647116],
    [2286, -32.902476, 151.582846],
    [2289, -32.950811, 151.694264],
    [2290, -32.981227, 151.711319],
    [2291, -32.937528, 151.759625],
    [2292, -32.912413, 151.73779],
    [2293, -32.920973, 151.76003],
    [2294, -32.916023, 151.765725],
    [2295, -32.91612, 151.78438],
    [2296, -32.911915, 151.745721],
    [2300, -32.929808, 151.777382],
    [2303, -32.934003, 151.747248],
    [2305, -32.932574, 151.690553],
    [2315, -32.724136, 152.174979],
    [2320, -32.696956, 151.48097],
    [2321, -32.676183, 151.60995],
    [2324, -32.635386, 151.871462],
    [2325, -32.9376, 151.142665],
    [2326, -32.813899, 151.459018],
    [2330, -32.580782, 151.127733],
]

START_DATE = datetime.date(2010, 7, 1)
END_DATE = datetime.date(2013, 7, 1)

for coordinate in coordinates:
    print("downloading {}...".format(coordinate[0]))

    current_date = START_DATE
    while  current_date < END_DATE:
        url = "https://darksky.net/details/{},{}/{}-{}-{}/si24/en".format(
            coordinate[1],
            coordinate[2],
            current_date.year,
            current_date.month,
            current_date.day,
        )
        file_name = current_date.strftime("{}/%Y-%m-%d.txt").format(coordinate[0])

        try:
            response = requests.get(url, headers={
                'user-agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.111 Safari/537.36',
                'accept-encoding': 'gzip, deflate',
            })
            response.raise_for_status()

            with open(file_name, "w") as f:
                f.write(response.text.encode("utf8"))
        except:
            print("couldn't download {}", file_name)

        current_date += datetime.timedelta(days=1)
